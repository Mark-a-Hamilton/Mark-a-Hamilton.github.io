<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark Hamilton BSc. (Hons. S/W Eng.)</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        crossorigin="anonymous" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" />
    <link rel="stylesheet" href=".\css\superhero.min.css" asp-append-version="true" />
    <link rel="stylesheet" href=".\css\layout.css" asp-append-version="true" />
    <link rel="stylesheet" href=".\css\style.css" asp-append-version="true" />
</head>

<body>
    <header class="navbar navbar-expand-lg header-center">
        <h1>Mark Hamilton BSc. (Hons. S/W Eng.)</h1>
    </header>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor04"
                aria-controls="navbarColor04" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" onclick="SwitchMode()" id="flexSwitchCheckDefault" />
                <label class="form-check-label" for="flexSwitchCheckDefault"><i
                        class="nav-link bi bi-circle-half"></i></label>
            </div>
            <div class="collapse navbar-collapse" id="navbarColor04">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href=".\index.html"><i class="bi bi-house-door-fill"></i>
                            <span class="visually-hidden">(current)</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main>
        <h2 class="header-center">API Template</h2>
        <hr>
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" data-bs-toggle="tab" href="#ovrvw" aria-selected="true"
                    role="tab">Overview</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" data-bs-toggle="tab" href="#strctr" aria-selected="false" tabindex="-1"
                    role="tab">Structure</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" data-bs-toggle="tab" href="#usg" aria-selected="false" tabindex="-1"
                    role="tab">Usage</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" data-bs-toggle="tab" href="#tips" aria-selected="false" tabindex="-1"
                    role="tab">Tips</a>
            </li>
        </ul>
        <div id="myTabContent" class="tab-content">
            <div id="ovrvw" class="tab-pane fade show active" role="tabpanel">
                <p>
                    The purpose of the API Template is to provide a starting point when creating a new Minimal API
                    (<b>Starting Point </b> A position where all preliminary configuration has been completed, so that
                    only coding required is to create the Endpoints and associated classes). The API-Template uses the
                    minimal API base, then restructures it. The default API is configured to allow it to connect to a
                    SQL Server Database, installs all necessary packages, Log table, Endpoints provided, As swagger /
                    OpenAPI is used by default as it is Industry standard, enables testing and documentation of the API.
                    <br> There are various reasons for the API Template, these are :-
                </p>
                <ol>
                    <li><b>Understanding</b> - Primarily to provide understanding of Minimal API's.</li>
                    <li><b>Starting Point</b> - On gaining an understanding it was soon evident that quite a bit of
                        configuration to get to a starting point. The reason why this is important is because if
                        developers waste time doing unnecessary steps this makes then less efficient whereby a template
                        will ensure that the developers only have to concentrate on the functionality of the Minimal
                        API. Also the more coding that is done the more the code will deviate from the agreed standard,
                        thus making maintaining / Developing code more problematic.
                    </li>
                    <li><b>Uniformity</b> - By keeping an agreed format between developers then all Minimal API's from whatever
                        project by whichever developer can be easily maintained / developed providing the developer is
                        familiar with the API-Template standard in place, as essentially although not identical they will be structurally similar.
                    </li>
                    <li><b>Structure</b> - The main changes are in the appsettings.json & Program.cs files have been
                        amended and a Library folder has been created which contains Contexts, Models, Endpoints &
                        Validators sub-folders which is where the main code is done. See the "Structure" tab for details on
                        the changes. The purpose of the Structure tab is to explain the standard used by the template. 
                    </li>
                    <li><b>Usage</b> - Feel Free to Clone the <a target="_blank"
                            href="https://github.com/Mark-a-Hamilton/Api-Template">API-Template</a> repository as it has
                        the standard MIT License also it may be advantageous to adapt it based on your typical Use Case.
                        I'm sure that you can workout how to use the template but for the intricacies see the "Usage"
                        tab. In contrast to the structure tab the purpose of the Usage tab is to explain how to apply the structure for future projects, This compliments the annotation inluded in the code.
                    </li>
                </ol>
            </div>
            <div id="strctr" class="tab-pane fade" role="tabpanel">
                <p>
                <ol>
                    <li>
                        <b>Pre-Requistes -</b> In order to make this project feasible then Windows SQL Server (Express)
                        & SQL Server Management Studio along with a database called "SolutionLog" which contains a "Log"
                        table, must exist.
                    </li>
                    <li>
                        <b>Configuration files -</b>
                        <ul>
                            <li><b>appsettings.json -</b> Contains configuration that is used for non-critical settings
                                which are usually cosmetic or optional functionality, as a result can be changed by
                                non-technical staff. and will only change settings that have not already been set in
                                other "appsettings.*.json" files.
                            </li>
                            <li>
                                <b>"appsettings.{ENVIRONMENT VARIABLE}.json! -</b> Contains configuration that is for
                                critical settings and as a result should be changed by technical staff. The default file
                                is "appsettings.Production.json" thus separating the responsibilities and maintaining
                                security. The ENVIRONMENT VARIABLE is acquired from either the profile defined in the "launchsettings.json" which resides in the Properties folder. Such settings include connection strings, logging details, etc. 
                            </li>
                        </ul>
                    </li>
                    <li>
                        <b>Setup -</b> Program.cs - has been changed in the following ways :- 
                        <ul>
                            <li><b>Weatherforecast Project </b> All elements specific to this project have been removed.</li>
                            <li><b>Validators </b> Have been added in this project just the LogValidator has been added however, as and when required other validators can be added.</li>
                            <li><b>Database Contexts </b> Other contexts can be added as required.</li>
                            <li><b>Endpoints </b> As The Endpoints have been moved out of the program.cs file they have been added here.</li>
                        </ul>
                        To Add new elements simply copy and change the defining elements using the appropriate parameters.
                    </li>
                    <li>
                        <b>Library Folders -</b> The main coding is done inside these folders :-
                        <ul><!--To Do-->
                            <li>
                                <b>Contexts -</b> Contains the LogContext.cs file which is where each model is
                                linked to the appropriate Model using the "DBSet" keyword. With the tablename used as
                                the context.
                            </li>
                            <li>
                                <b>Endpoints -</b> All the Endpoints should be located in here. Note Regions can be used to separate the Table Endpoints to keep the Endpoints structured. The code contains endpoints for the HTTP verbs GET, POST, PUT, PATCH & DELETE which work. This ultimately means that it is relatively simple to create new endpoints as required.  The Endpoints do not use any validation as this is done using the validation filters, thus separating responsibilities & making the Endpoints only have to do what is required i.e. CRUD operations. Which as well as simplifying code ensures less code. For Validations see the validations point below.
                            </li>
                            <li>
                                <b>Models -</b> Each table in the database has a class defining a basic Model the naming
                                convention is "{TABLENAME}.cs" so the log model resides in the "Log.cs" class. The definition can be extracted from tablename design feature in SQL Server Management Studio.
                            </li>
                            <li>
                                <b>Validations -</b> Validation.cs this is a generic class which utilises the Fluent Validations package and is the cornerstone on which validations rules are triggered using the "AddEndpointFilter&#60Validation&#60Log&#62&#62()" chained to appropriate  Endpoints (POST, PUT & PATCH). This Class should not be amended.
                            </li>
                        </ul>
                    </li>
                </ol>
                </p>
            </div>
            <div id="usg" class="tab-pane fade" role="tabpanel">
                <p>
                    The purpose of this section is to expand on the Structure tab to explain how to change each area to make your specific Minimal API so assuming The Pre-requisites have been met and the Configuration files have been correctly configured all we have to do is add the Classes in the Library Folder.
                    <ul>
                        <li><b>Models -</b> Each Table and view that requires endpoints creating should be created preferably in a separate
                            file. The Model is essentially a definition and should contain all fields in the table / view with the appropriate
                            type for each field is defined as a property in the class. The easiest way to do this is by right clicking on the
                            table / view in SQL Server Management Studio (SSMS) and selecting the "Design" option if so :- <br> Column Name = Id : Data Type = int : Allow nulls = false in SSMS Design View <br> public int Id { get; set; } <br> Column Name = [Level] : Data Type = nvarchar(MAX) : Allow nulls = true in SSMS Design View <br> public string? Level { get; set; } <br> you get the idea, nothing complicated.
                        </li>
                        <li><b>Contexts -</b>The contexts refers to each model and each Model contains a method starting with <br> DbSet&#60LogModel&#62 Log { get; set; } .</li>
                        <li><b>Endpoints -</b>The enpoints are where the coding is done to interract with the database therefore it is necessary to do the following:- 
                        <ol>
                            <li><b>Regions </b>should be created in order to maintain an element of structure and order.</li>
                            <li><b>Identify </b>the required Endpoints for each region from the specification copying existing endpoints for the initial code.</li>
                            <li><b>Delete </b>any Unrequired endpoints to eliminate any potentail security vulnarabilities.</li>
                            <li><b>Adapt </b>each endpoint to do the required functionality ensuring the correct Model is in use. and the endpoint behaves as required.</li>
                            <li><b>Validation </b>All endpoints should contain validation as it xhould not be relied on that the application will contain appropriate validation also this is a measure to prevent hackers from exploiting the api. Not forgetting that the api will potentially be used by external developers.</li>
                            <li><b>Testing </b>ultimately the endpoints should be tested in integration testing, ensuring the endpoint not only work as designed but identify and resolve any vulnerabilities identified. </li>
                        </ol></li>
                    </ul>
                </p>
            </div>
            <div id="tips" class="tab-pane fade" role="tabpanel">
                <p>
                    Doing this project I followed videos to arrive at a working Minimal API after copying stages in the
                    videos to the letter or so I thought. When the project was first run I expected the same results as
                    the videos, which was the swagger front end with each of the endpoints reflected. However, I got
                    swagger front end but with a stack trace. So how did I come to the finished API-Template? Easy in 3
                    steps :-
                    <ol>
                        <li><b>Stack Trace - </b>Highlight and copy the entire stack trace.</li>
                        <li><b>Artificial Intelligence (AI) - </b>Paste the Stack Trace into MS-Edge Co-Pilot.</li>
                        <li><b>Fix - </b>Once Co-Pilot had explained the problem it was easy to fix.</li>
                    </ol>
                    This example demonstrates the power of AI, as most of my IT career has been in support which included analysing stack 
                    traces with no access to source code then it is clear how simply copying a stack trace into an AI tool improves the
                    support service.
                </p>
                <P>
                    When writing code it is likely that there will be a time when it is not possible to understand why code does not work
                    by using breakpoints in conjumction with Watch windows and immediate Windows to see what exactly is happening.
                </P>
            </div>
        </div>
    </main>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"></script>
    <script src=".\js\script.js"></script>
</body>
<footer>
    <br> &copy;opyright - Mark Hamilton - All rights Reserved 2024<br>
</footer>

</html>